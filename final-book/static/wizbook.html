<!DOCTYPE html>
<html lang="en">
<head>
  <title>WizBook.io - AI Book Generator</title>
  <meta name="description" content="Turn ideas into books in 60 seconds">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta charset="UTF-8">
  
  <!-- React & Babel with Fallback -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  
  <!-- CDN Fallback Check -->
  <script>
    if (typeof React === 'undefined') {
      document.write('<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"><\/script>');
      document.write('<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"><\/script>');
    }
  </script>
  
  <!-- Stripe -->
  <script src="https://js.stripe.com/v3/"></script>
  
  <!-- Styles -->
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      line-height: 1.6;
    }
    
    .countdown-banner {
      background: linear-gradient(135deg, #dc2626, #b91c1c);
      color: white;
      text-align: center;
      padding: 15px 20px;
      position: sticky;
      top: 0;
      z-index: 1000;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      animation: pulse 2s infinite;
    }

    .countdown-banner h4 {
      margin: 0;
      font-size: 1.2rem;
      font-weight: bold;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .countdown-timer {
      font-size: 1.5rem;
      font-weight: 800;
      margin-top: 5px;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.02); }
      100% { transform: scale(1); }
    }

    .hero {
      text-align: center;
      padding: 80px 20px 60px;
      color: white;
    }
    
    .hero h1 {
      font-size: 4rem;
      font-weight: 800;
      margin-bottom: 20px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }
    
    .hero .tagline {
      font-size: 1.5rem;
      opacity: 0.9;
      font-weight: 300;
    }
    
    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 0 20px;
    }
    
    .card {
      background: rgba(255, 255, 255, 0.98);
      backdrop-filter: blur(10px);
      border-radius: 24px;
      padding: 40px;
      margin: 30px 0;
      box-shadow: 0 20px 60px rgba(0,0,0,0.15);
      border: 1px solid rgba(255,255,255,0.2);
    }
    
    .input-group {
      margin-bottom: 25px;
    }
    
    .input-group label {
      display: block;
      font-weight: 600;
      margin-bottom: 8px;
      color: #374151;
      font-size: 1.1rem;
    }
    
    .input-group input, .input-group select {
      width: 100%;
      padding: 16px 20px;
      border: 2px solid #e5e7eb;
      border-radius: 12px;
      font-size: 1.1rem;
      transition: all 0.3s ease;
      background: #fafafa;
    }
    
    .input-group input:focus, .input-group select:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
      background: white;
    }
    
    .btn {
      padding: 18px 36px;
      border: none;
      border-radius: 12px;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-block;
      text-align: center;
      position: relative;
      overflow: hidden;
    }
    
    .btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      transition: left 0.5s;
    }
    
    .btn:hover::before {
      left: 100%;
    }
    
    .btn-primary {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
    }
    
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(102, 126, 234, 0.6);
    }
    
    .btn-success {
      background: linear-gradient(135deg, #10b981, #059669);
      color: white;
      box-shadow: 0 4px 15px rgba(16, 185, 129, 0.4);
    }
    
    .btn-success:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(16, 185, 129, 0.6);
    }
    
    .btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }
    
    .btn-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
      margin: 30px 0;
    }
    
    .loading {
      text-align: center;
      padding: 60px 20px;
    }
    
    .spinner {
      width: 50px;
      height: 50px;
      border: 4px solid #f3f4f6;
      border-top: 4px solid #667eea;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 20px;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .result {
      background: #f8fafc;
      border: 1px solid #e2e8f0;
      border-radius: 16px;
      padding: 30px;
      margin: 25px 0;
      position: relative;
    }
    
    .result pre {
      white-space: pre-wrap;
      font-size: 0.95rem;
      line-height: 1.7;
      max-height: 500px;
      overflow-y: auto;
      font-family: 'Georgia', serif;
      color: #374151;
    }
    
    .alert {
      padding: 16px 20px;
      border-radius: 12px;
      margin: 20px 0;
      font-weight: 500;
    }
    
    .alert-success {
      background: #d1fae5;
      color: #065f46;
      border: 1px solid #10b981;
    }
    
    .alert-error {
      background: #fee2e2;
      color: #b91c1c;
      border: 1px solid #f87171;
    }
    
    .features {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 30px;
      margin: 40px 0;
    }
    
    .feature {
      text-align: center;
      padding: 30px 20px;
      background: rgba(255,255,255,0.1);
      border-radius: 16px;
      backdrop-filter: blur(10px);
    }
    
    .feature-icon {
      font-size: 3.5rem;
      margin-bottom: 15px;
      display: block;
    }
    
    .feature h3 {
      color: white;
      font-size: 1.3rem;
      margin-bottom: 10px;
    }
    
    .feature p {
      color: rgba(255,255,255,0.8);
      font-size: 1rem;
    }
    
    .stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin: 30px 0;
      text-align: center;
    }
    
    .stat {
      background: rgba(255,255,255,0.1);
      padding: 20px;
      border-radius: 12px;
      backdrop-filter: blur(10px);
    }
    
    .stat-number {
      font-size: 2.5rem;
      font-weight: 800;
      color: white;
      display: block;
    }
    
    .stat-label {
      color: rgba(255,255,255,0.8);
      font-size: 0.9rem;
      margin-top: 5px;
    }
    
    .pricing-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 30px;
      margin: 40px 0;
      max-width: 1000px;
      margin-left: auto;
      margin-right: auto;
    }

    .pricing-card {
      background: white;
      border: 2px solid #e5e7eb;
      border-radius: 20px;
      padding: 40px 30px;
      text-align: center;
      position: relative;
      transition: all 0.3s ease;
      cursor: pointer;
      min-height: 450px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }

    .pricing-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 40px rgba(0,0,0,0.1);
    }

    .pricing-card.highlighted {
      border: 3px solid #667eea;
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.02), rgba(118, 75, 162, 0.02));
      transform: scale(1.05);
    }

    .pricing-card.selected {
      border: 3px solid #10b981;
      background: rgba(16, 185, 129, 0.03);
    }

    .badge {
      position: absolute;
      top: -15px;
      left: 50%;
      transform: translateX(-50%);
      background: #f59e0b;
      color: white;
      padding: 8px 20px;
      border-radius: 25px;
      font-size: 0.85rem;
      font-weight: bold;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .badge.business {
      background: #dc2626;
    }

    .pricing-card h3 {
      font-size: 2rem;
      font-weight: bold;
      color: #1f2937;
      margin-bottom: 15px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .price {
      font-size: 3.5rem;
      font-weight: 800;
      color: #667eea;
      margin-bottom: 25px;
      line-height: 1;
    }

    .pricing-card ul {
      list-style: none;
      padding: 0;
      margin: 25px 0;
      flex-grow: 1;
    }

    .pricing-card li {
      padding: 12px 0;
      color: #374151;
      font-size: 1.1rem;
      border-bottom: 1px solid #f3f4f6;
      display: flex;
      align-items: center;
      justify-content: flex-start;
    }

    .pricing-card li:last-child {
      border-bottom: none;
    }

    .pricing-card li::before {
      content: '✓';
      color: #10b981;
      font-weight: bold;
      font-size: 1.3rem;
      margin-right: 12px;
      flex-shrink: 0;
    }

    .cta {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      border: none;
      padding: 18px 40px;
      border-radius: 12px;
      font-size: 1.2rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-top: 20px;
    }

    .cta:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
    }

    .cta.primary {
      background: linear-gradient(135deg, #10b981, #059669);
      box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
    }

    .cta.business {
      background: linear-gradient(135deg, #dc2626, #b91c1c);
      box-shadow: 0 4px 15px rgba(220, 38, 38, 0.3);
    }

    .delivery-time {
      color: #6b7280;
      font-size: 0.95rem;
      font-style: italic;
      margin-bottom: 10px;
    }
    @media (max-width: 768px) {
      .countdown-banner {
        padding: 12px 15px;
      }
      
      .countdown-banner h4 {
        font-size: 1rem;
      }
      
      .countdown-timer {
        font-size: 1.2rem;
      }

      .hero h1 {
        font-size: 2.5rem;
      }
      
      .hero .tagline {
        font-size: 1.2rem;
      }
      
      .card {
        padding: 25px;
        margin: 20px 0;
      }
      
      .btn-grid {
        grid-template-columns: 1fr;
      }

      .pricing-grid {
        grid-template-columns: 1fr;
        gap: 20px;
      }

      .pricing-card {
        min-height: auto;
        padding: 30px 20px;
      }

      .pricing-card.highlighted {
        transform: none;
      }
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    // Countdown Timer Logic
    const deadline = new Date();
    deadline.setDate(deadline.getDate() + 5); // 5-day countdown

    function CountdownBanner() {
      const [timeLeft, setTimeLeft] = useState('');

      useEffect(() => {
        function updateTimer() {
          const now = new Date();
          const diff = deadline - now;
          
          if (diff > 0) {
            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            
            if (days > 0) {
              setTimeLeft(`${days} DAYS LEFT AT CURRENT PRICES`);
            } else if (hours > 0) {
              setTimeLeft(`${hours} HOURS LEFT AT CURRENT PRICES`);
            } else {
              setTimeLeft(`${minutes} MINUTES LEFT AT CURRENT PRICES`);
            }
          } else {
            setTimeLeft('PRICES HAVE INCREASED!');
          }
        }

        updateTimer(); // Initial call
        const interval = setInterval(updateTimer, 1000);
        return () => clearInterval(interval);
      }, []);

      return (
        <div className="countdown-banner">
          <h4>🔥 LIMITED TIME OFFER</h4>
          <div className="countdown-timer">{timeLeft}</div>
        </div>
      );
    }

    function WizBookApp() {
      const [step, setStep] = useState('home'); // home, pricing, upsells, generate, result
      const [selectedTier, setSelectedTier] = useState('pro');
      const [selectedUpsells, setSelectedUpsells] = useState([]);
      const [formData, setFormData] = useState({
        topic: '',
        audience: 'beginners',
        style: 'professional'
      });
      const [loading, setLoading] = useState(false);
      const [result, setResult] = useState(null);
      const [error, setError] = useState('');

      // Premium Pricing Tiers
      const pricingTiers = {
        basic: { 
          price: 47, 
          name: 'Basic', 
          delivery: '24hr delivery',
          features: ['AI-generated PDF', 'Standard cover', 'Watermarked footer', '24hr delivery'] 
        },
        pro: { 
          price: 97, 
          name: 'Professional', 
          delivery: '12hr delivery',
          features: ['Everything in Basic', 'Audio narration (AI)', 'Editable DOCX', '3 premium covers', '12hr delivery', '⭐ MOST POPULAR'] 
        },
        whitelabel: { 
          price: 497, 
          name: 'White Label', 
          delivery: 'Instant access',
          features: ['Everything in Pro', 'Remove branding', 'Commercial rights', '100 books/month license', '🚀 BUSINESS SOLUTION'] 
        }
      };

      // Upsell Options
      const upsells = {
        formatting: {
          id: 'formatting',
          title: 'Professional Formatting',
          price: 29.99,
          originalPrice: 49.99,
          description: 'Premium typography, margins, and layout design',
          features: ['Custom typography', 'Professional margins', 'Chapter styling', 'Table of contents']
        },
        printReady: {
          id: 'printReady',
          title: 'Print-Ready PDF',
          price: 49.00,
          description: 'CMYK color profile + Print bleed setup + High-res graphics',
          features: ['CMYK color profile', 'Print bleed margins', 'High-resolution graphics', 'Professional binding ready']
        },
        rushDelivery: {
          id: 'rushDelivery', 
          title: 'Rush Delivery',
          price: 19.99,
          description: '2-hour delivery instead of standard timing',
          features: ['2-hour delivery', 'Priority processing', 'Instant notifications']
        },
        audioUpgrade: {
          id: 'audioUpgrade',
          title: 'Premium Audio',
          price: 39.99,
          description: 'Professional voice actor + Background music + Chapter breaks',
          features: ['Professional voice actor', 'Background music', 'Chapter break sounds', 'Multiple voice options']
        }
      };

      // Auto-detect API URL - PRODUCTION READY
      const API_URL = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1'
        ? 'http://localhost:8001'  // Local development
        : 'https://wizbook.io';  // PRODUCTION DOMAIN - LIVE!

      const handleGenerate = async () => {
        if (!formData.topic.trim()) {
          setError('Please enter a book topic');
          return;
        }

        setLoading(true);
        setError('');

        try {
          const response = await fetch(`${API_URL}/api/generate?topic=${encodeURIComponent(formData.topic)} for ${formData.audience} in ${formData.style} style`);
          
          if (!response.ok) {
            throw new Error(`Generation failed: ${response.status}`);
          }

          const data = await response.json();
          setResult(data);
          setStep('result');
        } catch (err) {
          setError('Failed to generate book. Please try again.');
          console.error('Error:', err);
        }

        setLoading(false);
      };

      const handleDownloadPDF = async () => {
        if (!result) return;

        try {
          const response = await fetch(`${API_URL}/api/pdf?topic=${encodeURIComponent(formData.topic)}`);
          
          if (!response.ok) {
            throw new Error('PDF generation failed');
          }

          const blob = await response.blob();
          const url = window.URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url;
          a.download = `${formData.topic.replace(/[^a-z0-9]/gi, '_')}.pdf`;
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
          window.URL.revokeObjectURL(url);
        } catch (err) {
          setError('PDF download failed. Please try again.');
        }
      };

      const handlePayment = async () => {
        const totalUpsellPrice = selectedUpsells.reduce((sum, id) => sum + upsells[id].price, 0);
        const finalPrice = pricingTiers[selectedTier].price + totalUpsellPrice;
        
        try {
          const upsellParams = selectedUpsells.length > 0 ? `&upsells=${selectedUpsells.join(',')}` : '';
          const response = await fetch(`${API_URL}/api/checkout?topic=${encodeURIComponent(formData.topic)}&tier=${selectedTier}${upsellParams}`);
          const data = await response.json();
          
          if (data.checkout_url) {
            window.location.href = data.checkout_url;
          } else {
            setError('Payment setup required. Please add Stripe keys.');
          }
        } catch (err) {
          setError('Payment failed. Please try again.');
        }
      };

      const handleGenerateClick = () => {
        setStep('pricing');
      };

      const handlePricingContinue = () => {
        // Show upsells based on selected tier
        if (selectedTier === 'basic' || selectedTier === 'pro') {
          setStep('upsells');
        } else {
          handlePayment(); // Skip upsells for white label
        }
      };

      const toggleUpsell = (upsellId) => {
        setSelectedUpsells(prev => 
          prev.includes(upsellId) 
            ? prev.filter(id => id !== upsellId)
            : [...prev, upsellId]
        );
      };

      const getRecommendedUpsells = () => {
        if (selectedTier === 'basic') {
          return ['formatting', 'rushDelivery'];
        } else if (selectedTier === 'pro') {
          return ['printReady', 'audioUpgrade'];
        }
        return [];
      };

      if (loading) {
        return (
          <div className="loading">
            <div className="spinner"></div>
            <h2 style={{color: 'white', marginBottom: '10px'}}>🤖 Creating your book...</h2>
            <p style={{color: 'rgba(255,255,255,0.8)'}}>This may take 10-30 seconds for quality content</p>
          </div>
        );
      }

      if (step === 'result' && result) {
        return (
          <div className="container">
            <div className="card">
              <div style={{textAlign: 'center', marginBottom: '30px'}}>
                <h2 style={{color: '#1f2937', fontSize: '2rem', marginBottom: '10px'}}>
                  📚 Your Book is Ready!
                </h2>
                <div className="stats">
                  <div className="stat">
                    <span className="stat-number" style={{color: '#059669'}}>{result.word_count}</span>
                    <div className="stat-label" style={{color: '#6b7280'}}>Words Generated</div>
                  </div>
                  <div className="stat">
                    <span className="stat-number" style={{color: '#dc2626'}}>PDF</span>
                    <div className="stat-label" style={{color: '#6b7280'}}>Ready to Download</div>
                  </div>
                </div>
              </div>

              <div style={{textAlign: 'center', marginBottom: '30px'}}>
                <button className="btn btn-success" onClick={handleDownloadPDF} style={{marginRight: '15px'}}>
                  📄 Download PDF
                </button>
                <button className="btn btn-primary" onClick={() => setStep('home')}>
                  📝 Generate Another
                </button>
              </div>

              <div className="result">
                <pre>{result.book}</pre>
              </div>
            </div>
          </div>
        );
      }

      if (step === 'pricing') {
        return (
          <div className="container">
            <div className="card">
              <h2 style={{textAlign: 'center', marginBottom: '20px', color: '#1f2937', fontSize: '2.2rem'}}>
                Choose Your Book Package
              </h2>
              <p style={{textAlign: 'center', marginBottom: '40px', color: '#6b7280'}}>
                Topic: <strong>{formData.topic}</strong>
              </p>

              <div className="pricing-grid">
                {/* Basic Tier */}
                <div 
                  className={`pricing-card ${selectedTier === 'basic' ? 'selected' : ''}`}
                  onClick={() => setSelectedTier('basic')}
                >
                  <h3>Basic</h3>
                  <p className="price">$47 <span style={{fontSize: '1rem', color: '#dc2626', textDecoration: 'line-through'}}>$67</span></p>
                  <div className="delivery-time">24hr delivery</div>
                  <ul>
                    <li>AI-generated PDF</li>
                    <li>Standard cover</li>
                    <li>Watermarked footer</li>
                    <li>Email delivery</li>
                  </ul>
                  <button className="cta">Get Started</button>
                </div>

                {/* Pro Tier (Recommended) */}
                <div 
                  className={`pricing-card highlighted ${selectedTier === 'pro' ? 'selected' : ''}`}
                  onClick={() => setSelectedTier('pro')}
                >
                  <div className="badge">BEST VALUE - SAVE $50</div>
                  <h3>Professional</h3>
                  <p className="price">$97 <span style={{fontSize: '1rem', color: '#dc2626', textDecoration: 'line-through'}}>$147</span></p>
                  <div className="delivery-time">12hr delivery</div>
                  <ul>
                    <li><strong>Everything in Basic +</strong></li>
                    <li>AI Audio narration</li>
                    <li>Editable DOCX files</li>
                    <li>3 premium covers</li>
                    <li>Priority support</li>
                  </ul>
                  <button className="cta primary">Get Pro</button>
                </div>

                {/* White Label Tier */}
                <div 
                  className={`pricing-card ${selectedTier === 'whitelabel' ? 'selected' : ''}`}
                  onClick={() => setSelectedTier('whitelabel')}
                >
                  <div className="badge business">BUSINESS</div>
                  <h3>White Label</h3>
                  <p className="price">$497</p>
                  <div className="delivery-time">Instant access</div>
                  <ul>
                    <li><strong>Everything in Pro +</strong></li>
                    <li>Remove all branding</li>
                    <li>Full commercial rights</li>
                    <li>100 books/month license</li>
                    <li>API access</li>
                  </ul>
                  <button className="cta business">Start Business</button>
                </div>
              </div>

              <div style={{textAlign: 'center', marginTop: '40px'}}>
                <button 
                  className="btn btn-primary" 
                  onClick={handlePricingContinue}
                  style={{
                    fontSize: '1.3rem', 
                    padding: '25px 60px', 
                    marginRight: '20px'
                  }}
                >
                  {selectedTier === 'whitelabel' ? '🚀 Get Business License' : '💎 Continue to Checkout'} - ${pricingTiers[selectedTier].price}
                </button>
                <button 
                  className="btn" 
                  onClick={() => setStep('home')}
                  style={{fontSize: '1rem', padding: '20px 35px', background: '#f3f4f6', color: '#374151'}}
                >
                  ← Back
                </button>
              </div>
            </div>
          </div>
        );
      }

      if (step === 'upsells') {
        const recommendedUpsells = getRecommendedUpsells();
        const totalUpsellPrice = selectedUpsells.reduce((sum, id) => sum + upsells[id].price, 0);
        const finalPrice = pricingTiers[selectedTier].price + totalUpsellPrice;

        return (
          <div className="container">
            <div className="card">
              <div style={{textAlign: 'center', marginBottom: '30px'}}>
                <h2 style={{color: '#1f2937', fontSize: '2.2rem', marginBottom: '10px'}}>
                  🚀 Boost Your Book's Impact
                </h2>
                <p style={{color: '#6b7280', fontSize: '1.1rem'}}>
                  Selected: <strong>{pricingTiers[selectedTier].name}</strong> (${pricingTiers[selectedTier].price})
                </p>
                <div style={{background: '#f59e0b', color: 'white', padding: '8px 20px', borderRadius: '20px', display: 'inline-block', fontSize: '0.9rem', fontWeight: 'bold', marginTop: '10px'}}>
                  LIMITED TIME: Save up to 40% on add-ons
                </div>
              </div>

              <div style={{display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(320px, 1fr))', gap: '20px', marginBottom: '40px'}}>
                {recommendedUpsells.map(upsellId => {
                  const upsell = upsells[upsellId];
                  const isSelected = selectedUpsells.includes(upsellId);
                  
                  return (
                    <div
                      key={upsellId}
                      onClick={() => toggleUpsell(upsellId)}
                      style={{
                        border: isSelected ? '3px solid #10b981' : '2px solid #e5e7eb',
                        borderRadius: '16px',
                        padding: '25px',
                        cursor: 'pointer',
                        background: isSelected ? 'rgba(16, 185, 129, 0.05)' : 'white',
                        transition: 'all 0.3s ease',
                        position: 'relative'
                      }}
                    >
                      {isSelected && (
                        <div style={{
                          position: 'absolute',
                          top: '15px',
                          right: '15px',
                          background: '#10b981',
                          color: 'white',
                          borderRadius: '50%',
                          width: '24px',
                          height: '24px',
                          display: 'flex',
                          alignItems: 'center',
                          justifyContent: 'center',
                          fontSize: '0.8rem'
                        }}>
                          ✓
                        </div>
                      )}

                      <h3 style={{fontSize: '1.4rem', marginBottom: '10px', color: '#1f2937'}}>{upsell.title}</h3>
                      
                      <div style={{display: 'flex', alignItems: 'center', marginBottom: '15px'}}>
                        <span style={{fontSize: '2rem', fontWeight: 'bold', color: '#10b981'}}>
                          ${upsell.price}
                        </span>
                        {upsell.originalPrice && (
                          <span style={{fontSize: '1.2rem', color: '#9ca3af', textDecoration: 'line-through', marginLeft: '10px'}}>
                            ${upsell.originalPrice}
                          </span>
                        )}
                      </div>

                      <p style={{color: '#6b7280', marginBottom: '20px', fontSize: '1rem'}}>
                        {upsell.description}
                      </p>

                      <ul style={{listStyle: 'none', padding: 0}}>
                        {upsell.features.map((feature, index) => (
                          <li key={index} style={{padding: '6px 0', color: '#374151', display: 'flex', alignItems: 'center'}}>
                            <span style={{color: '#10b981', marginRight: '10px'}}>✓</span>
                            {feature}
                          </li>
                        ))}
                      </ul>
                    </div>
                  );
                })}
              </div>

              <div style={{textAlign: 'center', background: '#f8fafc', padding: '25px', borderRadius: '12px', marginBottom: '30px'}}>
                <h3 style={{color: '#1f2937', marginBottom: '15px'}}>📊 Your Order Summary</h3>
                <div style={{fontSize: '1.1rem', color: '#6b7280', marginBottom: '10px'}}>
                  {pricingTiers[selectedTier].name}: ${pricingTiers[selectedTier].price}
                </div>
                {selectedUpsells.map(id => (
                  <div key={id} style={{fontSize: '1rem', color: '#6b7280', marginBottom: '5px'}}>
                    + {upsells[id].title}: ${upsells[id].price}
                  </div>
                ))}
                <hr style={{margin: '15px 0', border: '1px solid #e5e7eb'}} />
                <div style={{fontSize: '1.8rem', fontWeight: 'bold', color: '#1f2937'}}>
                  Total: ${finalPrice}
                  {totalUpsellPrice > 0 && (
                    <span style={{fontSize: '1.2rem', color: '#10b981', marginLeft: '10px'}}>
                      (Save ${(recommendedUpsells.reduce((sum, id) => sum + (upsells[id].originalPrice || upsells[id].price), 0) - (pricingTiers[selectedTier].price + totalUpsellPrice)).toFixed(2)})
                    </span>
                  )}
                </div>
              </div>

              <div style={{textAlign: 'center'}}>
                <button 
                  className="btn btn-primary" 
                  onClick={handlePayment}
                  style={{fontSize: '1.3rem', padding: '25px 60px', marginRight: '20px'}}
                >
                  💳 Complete Order - ${finalPrice}
                </button>
                <button 
                  className="btn" 
                  onClick={() => setStep('pricing')}
                  style={{fontSize: '1rem', padding: '20px 35px', background: '#f3f4f6', color: '#374151'}}
                >
                  ← Back to Pricing
                </button>
              </div>
            </div>
          </div>
        );
      }

      return (
        <>
          <CountdownBanner />
          <div className="hero">
            <h1>📖 WizBook.io</h1>
            <p className="tagline">Professional AI Books for Business Leaders</p>
            
            <div className="features">
              <div className="feature">
                <span className="feature-icon">⚡</span>
                <h3>Enterprise Quality</h3>
                <p>Professional books with audio narration and premium covers</p>
              </div>
              <div className="feature">
                <span className="feature-icon">🎨</span>
                <h3>White Label Ready</h3>
                <p>Remove branding and get commercial rights for your business</p>
              </div>
              <div className="feature">
                <span className="feature-icon">📄</span>
                <h3>Multi-Format</h3>
                <p>PDF, DOCX, and AI audio narration included</p>
              </div>
            </div>
          </div>

          <div className="container">
            {error && (
              <div className="alert alert-error">
                {error}
              </div>
            )}

            <div className="card">
              <h2 style={{textAlign: 'center', marginBottom: '40px', color: '#1f2937', fontSize: '2.2rem'}}>
                Create Your Book
              </h2>

              <div className="input-group">
                <label htmlFor="topic">📚 What's your book about?</label>
                <input
                  id="topic"
                  type="text"
                  value={formData.topic}
                  onChange={(e) => setFormData({...formData, topic: e.target.value})}
                  placeholder="e.g., Python Programming, Digital Marketing, Coffee Shop Business Plan"
                  onKeyPress={(e) => e.key === 'Enter' && handleGenerate()}
                />
              </div>

              <div style={{display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '20px', marginBottom: '25px'}}>
                <div className="input-group">
                  <label htmlFor="audience">👥 Target Audience</label>
                  <select
                    id="audience"
                    value={formData.audience}
                    onChange={(e) => setFormData({...formData, audience: e.target.value})}
                  >
                    <option value="beginners">Complete Beginners</option>
                    <option value="intermediate">Intermediate Level</option>
                    <option value="advanced">Advanced Users</option>
                    <option value="professionals">Business Professionals</option>
                    <option value="students">Students</option>
                  </select>
                </div>

                <div className="input-group">
                  <label htmlFor="style">✍️ Writing Style</label>
                  <select
                    id="style"
                    value={formData.style}
                    onChange={(e) => setFormData({...formData, style: e.target.value})}
                  >
                    <option value="professional">Professional</option>
                    <option value="casual">Casual & Friendly</option>
                    <option value="academic">Academic</option>
                    <option value="conversational">Conversational</option>
                  </select>
                </div>
              </div>

              <div style={{textAlign: 'center'}}>
                <button 
                  className="btn btn-primary" 
                  onClick={handleGenerateClick}
                  disabled={loading || !formData.topic.trim()}
                  style={{fontSize: '1.2rem', padding: '20px 50px'}}
                >
                  📖 Create My Book →
                </button>
              </div>

              <div style={{textAlign: 'center', marginTop: '30px', fontSize: '0.9rem', color: '#6b7280'}}>
                <p>✨ Professional quality • Instant delivery • Watermarked PDFs</p>
              </div>
            </div>

            <div className="card" style={{textAlign: 'center', background: 'rgba(255,255,255,0.05)', border: '1px solid rgba(255,255,255,0.1)'}}>
              <h3 style={{color: 'white', marginBottom: '20px'}}>🔥 Premium Business Topics</h3>
              <div className="btn-grid">
                {[
                  'Executive Leadership Guide',
                  'Digital Transformation Strategy', 
                  'Sales Team Management',
                  'Customer Success Playbook',
                  'Remote Team Leadership',
                  'Business Process Optimization'
                ].map(topic => (
                  <button 
                    key={topic}
                    className="btn btn-primary"
                    onClick={() => setFormData({...formData, topic})}
                    style={{fontSize: '0.95rem', padding: '12px 20px'}}
                  >
                    {topic}
                  </button>
                ))}
              </div>
            </div>
          </div>
        </>
      );
    }

    ReactDOM.render(<WizBookApp />, document.getElementById('root'));
  </script>
</body>
</html>